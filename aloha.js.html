<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: aloha.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: aloha.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** Aloha Editor | Version 1.0 | github.com/alohaeditor */

// ==ClosureCompiler==
// @compilation_level ADVANCED_OPTIMIZATIONS
// @warning_level VERBOSE
// @jscomp_warning missingProperties
// @output_file_name aloha.min.js
// @check_types
// ==/ClosureCompiler==

define([
	'exports',
	'boundaries',
	'blocks',
	'dragdrop',
	'editables',
	'events',
	'functions',
	'keys',
	'maps',
	'mouse',
	'paste',
	'ranges',
	'selections',
	'selection-change',
	'typing',
	'undo'
], /** @exports Aloha */ function Aloha(
	Api,
	Boundaries,
	Blocks,
	DragDrop,
	Editables,
	Events,
	Fn,
	Keys,
	Maps,
	Mouse,
	Paste,
	Ranges,
	Selections,
	SelectionChange,
	Typing,
	Undo
) {
	'use strict';

	function setSelection(event) {
		if (event.range) {
			Ranges.select(event.range);
		}
		return event;
	}

	function editor(nativeEvent, custom) {
		var alohaEvent = custom || {'nativeEvent' : nativeEvent};
		alohaEvent.editor = editor;
		Fn.comp(
			setSelection,
			//Selections.handle,
			Typing.handle,
			Blocks.handle,
			DragDrop.handle,
			Paste.handle,
			function (alohaEvent) {
				alohaEvent.editable = alohaEvent.editor.editables[1];
				return alohaEvent;
			},
			Mouse.handle,
			Keys.handle
		)(alohaEvent);
	}

	editor.editables = {};
	editor.BLOCK_CLASS = 'aloha-block';
	editor.CARET_CLASS = 'aloha-caret';
	editor.selectionContext = Selections.Context();

	Events.setup(editor, document);

	/*
	SelectionChange.addHandler(document, SelectionChange.handler(
		Fn.partial(Boundaries.get, document),
		Boundaries.fromEndOfNode(document),
		function (boundaries, event) {
			editor(event);
		}
	));
	*/

	/**
	 * The Aloha Editor namespace root.
	 *
	 * Also serves as short aloha.aloha.
	 */
	function aloha(elem) {
		var editable = Editables.Editable(elem);
		editable.overrides = [];
		editable.settings = {
			defaultBlockNodeName: 'div'
		};
		Editables.assocIntoEditor(editor, editable);
		elem.setAttribute('contentEditable', 'true');
		Undo.enter(editable.undoContext, {
			meta: {type: 'external'},
			partitionRecords: true
		});
		editor(null, {
			'type'     : 'aloha',
			'editable' : editable
		});
	}

	function mahalo(elem) {
		var editable = Editables.fromElem(editor, elem);
		Editables.close(editable);
		Editables.dissocFromEditor(editor, editable);
		elem.removeAttribute('contentEditable');
		editor(null, {
			'type'     : 'mahalo',
			'editable' : editable
		});
	}

	Api['aloha'] = aloha;
	Api['mahalo'] = mahalo;

	aloha = Maps.extend(aloha, Api);

	window['aloha'] = aloha;

	var teaser = "       _       _                      _ _ _              \n"
	           + "  __ _| | ___ | |__   __ _    ___  __| (_) |_ ___  _ __  \n"
	           + " / _` | |/ _ \\| '_ \\ / _` |  / _ \\/ _` | | __/ _ \\| '__| \n"
	           + "| (_| | | (_) | | | | (_| | |  __/ (_| | | || (_) | |    \n"
	           + " \\__,_|_|\\___/|_| |_|\\__,_|  \\___|\\__,_|_|\\__\\___/|_|.org\n"
	           + "\n"
	           + "Aloha, there!\n"
	           + "\n"
	           + "Would you like to contribute to shaping the future of "
	           + "content editing on the web?\n"
	           + "\n"
	           + "Join the team at http://github.com/alohaeditor!";

	//console.log(teaser);

	return aloha;
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-accessor.html">accessor</a></li><li><a href="module-Aloha.html">Aloha</a></li><li><a href="module-Arrays.html">Arrays</a></li><li><a href="module-Assert.html">Assert</a></li><li><a href="module-Blocks.html">Blocks</a></li><li><a href="module-Boundaries.html">Boundaries</a></li><li><a href="module-BoundaryMarkers.html">BoundaryMarkers</a></li><li><a href="module-Browsers.html">Browsers</a></li><li><a href="module-Colors.html">Colors</a></li><li><a href="module-Content.html">Content</a></li><li><a href="module-Cursors.html">Cursors</a></li><li><a href="module-Dom.html">Dom</a></li><li><a href="module-DragDrop.html">DragDrop</a></li><li><a href="module-Editables.html">Editables</a></li><li><a href="module-Editing.html">Editing</a></li><li><a href="module-Ephemera.html">Ephemera</a></li><li><a href="module-Events.html">Events</a></li><li><a href="module-Xhtml.html">Xhtml</a></li></ul><h3>Global</h3><ul><li><a href="global.html#define">define</a></li><li><a href="global.html#require">require</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Mon Apr 07 2014 15:20:51 GMT+0400 (MSK)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
